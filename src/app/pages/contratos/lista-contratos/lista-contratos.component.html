<section class="home-section">
  <div class="filtros-extendidos">
    <input type="text" placeholder="Filtrar por nro. contrato..." [(ngModel)]="filtroCodigo" />
    <select [(ngModel)]="filtroEstado">
      <option value="">Todos los estados</option>
      <option value="Activo">Activo</option>
      <option value="Baja">Baja</option>
      <option value="Suspendido">Suspendido</option>
    </select>
    <button class="limpiar-btn" (click)="limpiarFiltros()">Limpiar filtros</button>
  </div>

  <div class="titulo-seccion">
    <h2>Contratos</h2>
    <button type="button" routerLink="/crear-contrato" class="btn-agregar">
      âž• Agregar nuevo contrato
    </button>
  </div>

  <table class="tabla-contratos">
    <thead>
      <tr>
        <th>Nro Contrato</th>
        <th>Tipo</th>
        <th>Saldo</th>
        <th>Fecha CreaciÃ³n</th>
        <th>Fecha ModificaciÃ³n</th>
        <th>Estado</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let contrato of contratosFiltrados">
        <td>{{ contrato.nroContrato }}</td>
        <td>{{ contrato.tipoContrato }}</td>
        <td>S/. {{ contrato.saldo | number:'1.0-2' }}</td>
        <td>{{ contrato.fechaCreacion | date:'dd/MM/yyyy' }}</td>
        <td>{{ contrato.fechaModificacion | date:'dd/MM/yyyy' }}</td>
        <td>
          <span [class.activo]="contrato.idEstado === 1" 
                [class.baja]="contrato.idEstado === 2" 
                [class.suspendido]="contrato.idEstado === 3">
            {{ estadoTexto(contrato.idEstado) }}
          </span>
        </td>
        <td>
          <button (click)="abrirModal(contrato)">Editar contrato</button>
        </td>
      </tr>
    </tbody>
  </table>

  <!-- ðŸ”¹ Modal de cambio de modalidad -->
  <div class="modal" *ngIf="mostrarModal">
    <div class="modal-contenido">
      <h3>Detalle del Contrato</h3>
      <div class="detalle-item"><strong>NÂ° Contrato:</strong> {{ contratoSeleccionado.nroContrato }}</div>
      <div class="detalle-item"><strong>Tipo:</strong> {{ contratoSeleccionado.tipoContrato }}</div>
      <div class="detalle-item"><strong>Saldo:</strong> S/. {{ contratoSeleccionado.saldo | number:'1.2-2' }}</div>
      <div class="detalle-item"><strong>Estado actual:</strong> {{ estadoTexto(contratoSeleccionado.idEstado) }}</div>

      <hr />

      <label for="modalidad"><strong>Nueva modalidad:</strong></label>
      <select id="modalidad" [(ngModel)]="nuevoEstado">
        <option [value]="1">Activo</option>
        <option [value]="2">Baja</option>
        <option [value]="3">Suspendido</option>
      </select>

      <div class="modal-acciones">
        <button (click)="guardarCambioModalidad()">Guardar cambios</button>
        <button class="cancelar" (click)="cerrarModal()">Cancelar</button>
      </div>
    </div>
  </div>
</section>
